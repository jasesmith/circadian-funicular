!function(e,t){"use strict";var i=function(e){var t={};return e&&(t={t:e.offsetTop,r:e.offsetLeft+e.offsetWidth,b:e.offsetTop+e.offsetHeight,l:e.offsetLeft,w:e.offsetWidth,h:e.offsetHeight},t.cx=t.l+t.w/2,t.cy=t.t+t.h/2),t},m=function(e,t){var m=i(t),n=Math.atan2(e.clientY-m.cy,e.clientX-m.cx),r=Math.round(180*n/Math.PI);return r},n=function(t,i){e.element(t).css({transform:"rotate("+i+"deg)"})},r=function(e,t){var i,m=3+1/30*(e%360);return m=0>m?m+12:m,i=parseInt(m),"m"===t&&(i=parseInt(5*m)%60),i};e.module("app").directive("timeDial",["$interval",function(i){return{restrict:"E",replace:!0,scope:{time:"=?",diameter:"=?",unit:"=?",mode:"@"},template:'<div><div class="time-dial barrel" ng-class="{\'clock-mode\': mode == \'tell\'}" ng-style="size(unit)"><div class="lcd" hm-tap="toggleMeridiem()"><div class="seconds" ng-if="mode==\'tell\'">{{format(time)|date:\'ss\'}}</div><div class="seconds" ng-if="mode!=\'tell\'">{{prevTick}}/{{rev}}</div><div class="time">{{format(time)|date:\'h\'}}<span>:</span>{{format(time)|date:\'mm\'}}</div><div class="meridiem">{{format(time)|date:\'a\'}}</div></div><div class="crown hour"><span hm-pan="setCrown($event, \'h\')"></span></div><div class="crown minute"><span hm-pan="setCrown($event, \'m\')"></span></div></div></div>',link:function(a,o){a.time||(a.time=t()),a.mode||(a.mode="set"),a.rev=0;var s=e.element(o.find(".minute")),d=e.element(o.find(".hour")),c=function(e,t){e=e?e:a.time;var i=e.minutes(),m=e.hours(),r=6*i-90,o=30*m+.5*i-450;t&&"m"!==t||n(s,r),t&&"h"!==t||n(d,o)};a.meridiem="am"===a.time.format("a")?"am":"pm",a.format=function(e){return new Date(e)},a.size=function(e){return e=e?e:"vmin",{fontSize:a.diameter+e}},a.toggleMeridiem=function(){"am"===a.meridiem?(a.time.add(12,"hours"),a.meridiem="pm"):(a.time.subtract(12,"hours"),a.meridiem="am")},a.setCrown=function(e,t){var i=m(e.pointers[0],o[0]),n=r(i,t),s=a.time,d=a.time.hour();"m"===t?(a.time.minute(n),59===a.prevTick&&0===n&&(s=a.time.add(1,"hour")),0===a.prevTick&&59===n&&(s=a.time.subtract(1,"hour")),c(s,"h")):(n=d>11?n+12:n,11===a.prevTick&&0===n?n+=12:23===a.prevTick&&12===n&&(a.time.add(1,"day"),n-=12),12===a.prevTick&&23===n?n-=12:0===a.prevTick&&11===n&&(a.time.subtract(1,"day"),n+=12),a.time.hour(n)),c(a.time,t),a.prevTick=n},c(),"tell"===a.mode&&i(function(){a.time=t(),c(a.time)},500)}}}])}(window.angular,window.moment);