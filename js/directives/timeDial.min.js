!function(e,t){"use strict";e.module("app").directive("timeDial",[function(){var i=function(e){var t={};return e&&(t={t:e.offsetTop,r:e.offsetLeft+e.offsetWidth,b:e.offsetTop+e.offsetHeight,l:e.offsetLeft,w:e.offsetWidth,h:e.offsetHeight},t.cx=t.l+t.w/2,t.cy=t.t+t.h/2),t},n=function(e,t){var n=i(t),m=Math.atan2(e.clientY-n.cy,e.clientX-n.cx),r=Math.round(180*m/Math.PI);return r},m=function(t,i){e.element(t).css({transform:"rotate("+i+"deg)"})},r=function(e,t){var i,n=3+1/30*(e%360);return n=0>n?n+12:n,i=parseInt(n),"m"===t&&(i=parseInt(5*n)%60),i};return{restrict:"E",replace:!0,scope:{time:"=?",diameter:"=?",unit:"=?"},template:'<div class="time-dial barrel" ng-style="styleMe(unit)"><div class="lcd" hm-tap="toggleMeridiem()"><div class="time">{{format(time)|date:\'h\'}}:{{format(time)|date:\'mm\'}}</div><div class="meridiem">{{format(time)|date:\'a\'}}</div></div><div class="crown hour"><span hm-pan="setCrown($event, \'h\')"></span></div><div class="crown minute"><span hm-pan="setCrown($event, \'m\')"></span></div></div>',link:function(i,a){i.time||(i.time=t());var o=e.element(a.find(".minute")),s=e.element(a.find(".hour")),d=function(e,t){e=e?e:i.time;var n=e.minutes(),r=e.hours(),a=6*n-90,d=30*r+.5*n-450;t&&"m"!==t||m(o,a),t&&"h"!==t||m(s,d)};i.meridiem="am"===i.time.format("a")?"am":"pm",i.format=function(e){return new Date(e)},i.styleMe=function(e){return e=e?e:"vmin",{fontSize:i.diameter+e}},i.toggleMeridiem=function(){"am"===i.meridiem?(i.time.add(12,"hours"),i.meridiem="pm"):(i.time.subtract(12,"hours"),i.meridiem="am")},i.setCrown=function(e,t){var m=n(e.pointers[0],a[0]),o=r(m,t);"m"===t?(i.time.minute(o),d(i.time,"h")):("pm"===i.meridiem&&(o+=12),i.time.hour(o)),d(i.time,t)},d()}}}])}(window.angular,window.moment);